<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FastScrollView - scrollToItem æ€§èƒ½æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f0f2f5;
      padding: 20px;
    }

    .header {
      max-width: 1200px;
      margin: 0 auto 20px;
      text-align: center;
    }

    .header h1 {
      font-size: 32px;
      color: #333;
      margin-bottom: 10px;
    }

    .header p {
      color: #666;
      font-size: 16px;
      margin-bottom: 10px;
    }

    .header .tip {
      background: #d1ecf1;
      color: #0c5460;
      padding: 10px 20px;
      border-radius: 8px;
      display: inline-block;
      font-size: 14px;
      margin-top: 10px;
    }

    .demo-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .demo-header {
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .demo-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .demo-subtitle {
      font-size: 14px;
      opacity: 0.9;
    }

    .controls-panel {
      padding: 20px;
      background: #f8f9fa;
      border-bottom: 1px solid #e0e0e0;
    }

    .controls-row {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .controls-row:last-child {
      margin-bottom: 0;
    }

    .control-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .control-label {
      font-size: 14px;
      color: #495057;
      font-weight: 500;
    }

    .input-number {
      width: 100px;
      padding: 8px 12px;
      border: 1px solid #ced4da;
      border-radius: 6px;
      font-size: 14px;
    }

    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      background: #667eea;
      color: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
      font-weight: 500;
    }

    .btn:hover {
      background: #5568d3;
      transform: translateY(-1px);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-success {
      background: #28a745;
    }

    .btn-success:hover {
      background: #218838;
    }

    .btn-primary {
      background: #007bff;
    }

    .btn-primary:hover {
      background: #0069d9;
    }

    .performance-info {
      padding: 15px 20px;
      background: #fff3cd;
      border-bottom: 1px solid #ffeaa7;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
    }

    .perf-item {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .perf-label {
      font-size: 12px;
      color: #856404;
      font-weight: 500;
    }

    .perf-value {
      font-size: 18px;
      font-weight: 600;
      color: #856404;
    }

    .perf-value.fast {
      color: #28a745;
    }

    .scroll-container {
      height: 500px;
      overflow: auto;
      background: white;
    }

    .item {
      padding: 15px 20px;
      border-bottom: 1px solid #e0e0e0;
      transition: background 0.15s;
    }

    .item:hover {
      background: #f8f9fa;
    }

    .item.highlight {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
    }

    .item-title {
      font-weight: 600;
      color: #202124;
      margin-bottom: 4px;
    }

    .item-subtitle {
      font-size: 13px;
      color: #5f6368;
    }

    .back-button {
      display: inline-block;
      margin-bottom: 20px;
      padding: 10px 20px;
      background: white;
      color: #667eea;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.2s;
    }

    .back-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    code {
      background: #f8f9fa;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      color: #e83e8c;
    }
  </style>
</head>
<body>
  <div style="max-width: 1200px; margin: 0 auto;">
    <a href="index.html" class="back-button">â† è¿”å›ç¤ºä¾‹åˆ—è¡¨</a>
  </div>

  <div class="header">
    <h1>âš¡ scrollToItem æ€§èƒ½ä¼˜åŒ–æµ‹è¯•</h1>
    <p>æ¼”ç¤ºä¼˜åŒ–åçš„ <code>scrollToItem()</code> æ–¹æ³•ï¼šå·²æ¸²æŸ“çš„ item ä¸ä¼šé‡æ–°æ¸²æŸ“</p>
    <div class="tip">
      ğŸ’¡ æç¤ºï¼šåœ¨å·²æ¸²æŸ“èŒƒå›´å†…è·³è½¬æ—¶ï¼Œæ€§èƒ½æå‡æ˜æ˜¾ï¼
    </div>
  </div>

  <div class="demo-container">
    <div class="demo-header">
      <div class="demo-title">æ€§èƒ½æµ‹è¯•é¢æ¿</div>
      <div class="demo-subtitle">æµ‹è¯•æ•°æ®ï¼š10,000 æ¡ | è§‚å¯Ÿæ€§èƒ½å·®å¼‚</div>
    </div>

    <div class="controls-panel">
      <div class="controls-row">
        <div class="control-group">
          <span class="control-label">è·³è½¬åˆ°é¡¹ç›®ï¼š</span>
          <input type="number" id="targetIndex" class="input-number" value="100" min="0" max="9999">
        </div>
        <button class="btn btn-primary" onclick="scrollToTarget()">è·³è½¬åˆ°æŒ‡å®šé¡¹</button>
      </div>

      <div class="controls-row">
        <button class="btn" onclick="scrollToItem(0)">è·³è½¬åˆ° #0</button>
        <button class="btn" onclick="scrollToItem(50)">è·³è½¬åˆ° #50ï¼ˆé™„è¿‘ï¼‰</button>
        <button class="btn" onclick="scrollToItem(100)">è·³è½¬åˆ° #100ï¼ˆé™„è¿‘ï¼‰</button>
        <button class="btn" onclick="scrollToItem(5000)">è·³è½¬åˆ° #5000ï¼ˆè¿œå¤„ï¼‰</button>
        <button class="btn btn-success" onclick="scrollToItem(9999)">è·³è½¬åˆ° #9999</button>
      </div>
    </div>

    <div class="performance-info">
      <div class="perf-item">
        <div class="perf-label">æ¸²æŸ“èŒƒå›´</div>
        <div class="perf-value" id="renderRange">-</div>
      </div>
      <div class="perf-item">
        <div class="perf-label">æ»šåŠ¨è€—æ—¶</div>
        <div class="perf-value fast" id="scrollTime">-</div>
      </div>
      <div class="perf-item">
        <div class="perf-label">æ˜¯å¦é‡æ–°æ¸²æŸ“</div>
        <div class="perf-value" id="rerendered">-</div>
      </div>
      <div class="perf-item">
        <div class="perf-label">DOM èŠ‚ç‚¹æ•°</div>
        <div class="perf-value" id="domCount">-</div>
      </div>
    </div>

    <div id="scroll-container" class="scroll-container"></div>
  </div>

  <script src="../dist/fast-scrollview.min.js"></script>
  <script>
    // ç”Ÿæˆæµ‹è¯•æ•°æ®
    function generateItems(count) {
      const items = [];
      for (let i = 0; i < count; i++) {
        items.push({
          id: i,
          title: `é¡¹ç›® #${i}`,
          content: `è¿™æ˜¯ç¬¬ ${i} é¡¹çš„å†…å®¹æè¿°ã€‚ç´¢å¼•: ${i}`
        });
      }
      return items;
    }

    // æ¸²æŸ“å‡½æ•°
    function renderItem(item, index) {
      return `
        <div class="item-title">${item.title}</div>
        <div class="item-subtitle">${item.content}</div>
      `;
    }

    // åˆ›å»º ScrollView å®ä¾‹
    const scrollView = new FastScrollView(
      '#scroll-container',
      generateItems(10000),
      renderItem,
      { bufferThreshold: 2 }
    );

    // æ›´æ–°æ€§èƒ½ä¿¡æ¯
    function updatePerformanceInfo() {
      const range = scrollView.getVisibleRange();
      const domCount = scrollView.contentContainer.children.length;
      
      document.getElementById('renderRange').textContent = 
        `#${range.start} - #${range.end} (${range.count} é¡¹)`;
      document.getElementById('domCount').textContent = domCount;
    }

    // åˆå§‹æ›´æ–°
    setTimeout(updatePerformanceInfo, 100);

    // è·³è½¬åˆ°æŒ‡å®šé¡¹
    function scrollToItem(index) {
      const startTime = performance.now();
      const oldRange = scrollView.getVisibleRange();
      
      // æ‰§è¡Œè·³è½¬
      scrollView.scrollToItem(index);
      
      // ç­‰å¾…æ¸²æŸ“å®Œæˆåæµ‹é‡
      setTimeout(() => {
        const endTime = performance.now();
        const duration = (endTime - startTime).toFixed(2);
        const newRange = scrollView.getVisibleRange();
        
        // åˆ¤æ–­æ˜¯å¦é‡æ–°æ¸²æŸ“ï¼ˆå¦‚æœèŒƒå›´å®Œå…¨æ”¹å˜ï¼Œè¯´æ˜é‡æ–°æ¸²æŸ“äº†ï¼‰
        const rerendered = (oldRange.start !== newRange.start || oldRange.end !== newRange.end);
        const wasInRange = index >= oldRange.start && index < oldRange.end;
        
        // æ›´æ–°æ€§èƒ½ä¿¡æ¯
        document.getElementById('scrollTime').textContent = `${duration} ms`;
        document.getElementById('scrollTime').className = duration < 10 ? 'perf-value fast' : 'perf-value';
        
        if (!wasInRange) {
          document.getElementById('rerendered').textContent = 'æ˜¯ï¼ˆè·³è·ƒæ¸²æŸ“ï¼‰';
          document.getElementById('rerendered').style.color = '#856404';
        } else {
          document.getElementById('rerendered').textContent = 'å¦ï¼ˆç›´æ¥æ»šåŠ¨ï¼‰';
          document.getElementById('rerendered').style.color = '#28a745';
        }
        
        updatePerformanceInfo();
        
        // é«˜äº®ç›®æ ‡é¡¹
        highlightItem(index);
      }, 100);
    }

    // è·³è½¬åˆ°è¾“å…¥çš„ç›®æ ‡
    function scrollToTarget() {
      const targetIndex = parseInt(document.getElementById('targetIndex').value);
      if (isNaN(targetIndex) || targetIndex < 0 || targetIndex >= 10000) {
        alert('è¯·è¾“å…¥ 0-9999 ä¹‹é—´çš„æ•°å­—');
        return;
      }
      scrollToItem(targetIndex);
    }

    // é«˜äº®æŒ‡å®šé¡¹
    function highlightItem(index) {
      // ç§»é™¤æ‰€æœ‰é«˜äº®
      document.querySelectorAll('.item').forEach(el => el.classList.remove('highlight'));
      
      // é«˜äº®ç›®æ ‡é¡¹
      const targetElement = scrollView.contentContainer.querySelector(`[data-index="${index}"]`);
      if (targetElement) {
        targetElement.classList.add('highlight');
        
        // 3ç§’åå–æ¶ˆé«˜äº®
        setTimeout(() => {
          targetElement.classList.remove('highlight');
        }, 3000);
      }
    }

    // ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œæ›´æ–°æ€§èƒ½ä¿¡æ¯
    let updateTimeout;
    document.getElementById('scroll-container').addEventListener('scroll', () => {
      clearTimeout(updateTimeout);
      updateTimeout = setTimeout(updatePerformanceInfo, 200);
    });
  </script>
</body>
</html>

